{"file":"araclar-DYxoJZAl.js","mappings":";;;;;;;;;;;;;;;;;;;AAsGE,UAAM,OAAO,IAAI,CAAA,CAAE;AACnB,UAAM,SAAS,IAAI,EAAE,SAAS,IAAI,aAAa,IAAI,OAAO,IAAI,cAAc,GAAI,CAAA;AAChF,UAAM,iBAAiB,IAAI,EAAE;AAC7B,UAAM,gBAAgB,IAAI,IAAI;AACN,QAAI,KAAK;AACb,QAAI,IAAI;AAG5B,UAAM,cAAc,IAAI,EAAE;AAG1B,UAAM,eAAe,IAAI,EAAE;AAC3B,UAAM,cAAc,IAAI,CAAC;AAGP,QAAI,KAAK;AACN,QAAI,EAAE;AAU3B,UAAM,eAAe,SAAS,MAAM;AAClC,aAAO,KAAK,MAAM,OAAO,SAAO;;AAC9B,cAAM,SAAS,YAAY,MAAM,YAAW;AAE5C,iBACE,gCAAK,YAAL,mBAAc,cAAc,SAAS,cACrC,gCAAK,gBAAL,mBAAkB,cAAc,SAAS,cACzC,gCAAK,UAAL,mBAAY,cAAc,SAAS,cACnC,gCAAK,iBAAL,mBAAmB,cAAc,SAAS,cAC1C,gCAAK,iBAAL,mBAAmB,cAAc,SAAS;AAAA,MAElD,CAAK;AAAA,IACL,CAAG;AAID,UAAM,gBAAgB,SAAS,MAAM;AACnC,YAAM,QAAQ;AACd,YAAM,MAAM,YAAY,QAAQ,aAAa;AAC7C,aAAO,aAAa,MAAM,MAAM,OAAO,GAAG;AAAA,IAC9C,CAAG;AAGD,UAAM,cAAc,SAAS,MAAM;AACjC,aAAO,YAAY,QAAQ,aAAa,QAAQ,aAAa,MAAM;AAAA,IACvE,CAAG;AAED,UAAM,cAAc,SAAS,MAAM;AACjC,aAAO,YAAY,UAAU;AAAA,IACjC,CAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["../../../../pages/araclar.vue"],"sourcesContent":["<template>\n  <div>\n    <h1>Araclar</h1>\n\n    <!-- Confirmation Modal for Deletion -->\n    <ClientOnly>\n      <ConfirmationModal \n        v-if=\"showDeleteModal\" \n        :showModal=\"showDeleteModal\" \n        title=\"Aracı Sil\" \n        message=\"Bu aracı silmek istediğinize emin misiniz?\"\n        @confirm=\"deleteCar\"\n        @cancel=\"cancelDelete\"\n      />\n    </ClientOnly>\n\n    <!-- Add New Car Section -->\n    <div class=\"add-car-section\">\n      <h3>Yeni Arac Ekle</h3>\n      <input v-model=\"newCar.arac_id\" placeholder=\"Arac plakasi\" />\n      <input v-model=\"newCar.arac_sahibi\" placeholder=\"Arac Sahibi\" />\n      <input v-model=\"newCar.adres\" placeholder=\"Adres\" />\n      <input v-model=\"newCar.arac_markasi\" placeholder=\"Arac Markası\" />\n      <button @click=\"addCar\">Arac Ekle</button>\n    </div>\n\n    <!-- Feedback message for successful car creation -->\n    <p v-if=\"successMessage\" class=\"success-message\">{{ successMessage }}</p>\n\n    <h3>Arac Listesi</h3>\n\n    <!-- Search cars -->\n    <input \n      v-model=\"searchQuery\" \n      placeholder=\"Arac plakasi, arac sahibi, arac markasi, adres, tarih ara\"\n      @keyup.enter=\"submitSearch\"\n      class=\"search-input\"\n    />\n    <table>\n    <thead>\n      <tr>\n        <th>Kayitli arac listesi. ({{ cars.length }} kayitli arac blunmaktadir) - Filtrelenen arac sayisi: {{ filteredCars.length }}: </th>\n      </tr>\n    </thead>\n    <tbody>\n      <template v-for=\"(car, index) in paginatedCars\" :key=\"index\" >\n        <tr\n          @click=\"toggleDetails(car.arac_id)\"\n        >\n          <td class=\"table-row\" title=\"Arac biligilerini göstermek icin tikla\">\n            <div class=\"arrow-wrapper\">\n              <span class=\"row-element-first arrow\">{{ expandedCarId === car.arac_id ? '↑' : '↓' }}</span>\n            </div>\n            <span class=\"row-element\">{{ car.arac_id }}</span>\n            <button class=\"row-element row-element-last remove-button\" @click.stop=\"confirmDelete(car.arac_id)\">Araci Sil</button>\n          </td>\n        </tr>\n        <tr v-if=\"expandedCarId === car.arac_id\" class=\"details-row\">\n          <td colspan=\"1\">\n            <!-- Display additional car details here -->\n            <div>\n              <p><strong>Arac Sahibi:</strong> {{ car.arac_sahibi }}</p>\n              <p><strong>Adres:</strong> {{ car.adres }}</p>\n              <p><strong>Kayıt Tarihi:</strong> {{ car.kayit_tarihi }}</p>\n              <p><strong>Arac Markası:</strong> {{ car.arac_markasi }}</p>\n            </div>\n          </td>\n        </tr>\n      </template>\n    </tbody>\n    </table>\n\n    <!-- Load More Button -->\n    <div class=\"buttons\">\n      <div>\n        <button \n          v-if=\"hasMoreCars\" \n          @click=\"loadMore\" \n          class=\"load-more-btn\"\n        >\n          Daha fazla arac göster\n        </button>\n\n        <button \n          v-if=\"hasLessCars\" \n          @click=\"loadLess\" \n          class=\"load-less-btn\"\n        >\n          Daha az arac göster\n        </button>\n      </div>\n    </div>\n\n    <ClientOnly>\n      <ErrorModal v-if=\"showError\" :showModal=\"showError\" :errorMessage=\"errorMessage\" @close=\"closeErrorModal\" />\n    </ClientOnly>\n  </div>\n</template>\n\n<script setup>\n  import ErrorModal from '~/components/ErrorModal.vue';\n  import ConfirmationModal from '~/components/ConfirmationModal.vue';\n  const cars = ref([]);\n  const newCar = ref({ arac_id: '', arac_sahibi: '', adres: '', arac_markasi: '' });\n  const successMessage = ref(''); // Feedback message for successful creation\n  const expandedCarId = ref(null); // Holds the ID of the expanded car\n  const showDeleteModal = ref(false);\n  const carToDelete = ref(null);\n    \n  // Search input value\n  const searchQuery = ref('');\n\n  // Number of cars to display initially\n  const itemsPerPage = ref(10);\n  const currentPage = ref(1);\n\n  // Error handling\n  const showError = ref(false)\n  const errorMessage = ref('')\n\n  const toggleDetails = (arac_id) => {\n    expandedCarId.value = expandedCarId.value === arac_id ? null : arac_id;\n  };\n\n  const closeErrorModal = () => {\n    showError.value = false\n  }\n\n  const filteredCars = computed(() => {\n    return cars.value.filter(car => {\n      const search = searchQuery.value.toLowerCase();\n\n      return (\n        car?.arac_id?.toLowerCase().includes(search) ||\n        car?.arac_sahibi?.toLowerCase().includes(search) ||\n        car?.adres?.toLowerCase().includes(search) ||\n        car?.arac_markasi?.toLowerCase().includes(search) ||\n        car?.kayit_tarihi?.toLowerCase().includes(search)\n      );\n    });\n  });\n\n\n  // Paginated cars\n  const paginatedCars = computed(() => {\n    const start = 0;\n    const end = currentPage.value * itemsPerPage.value\n    return filteredCars.value.slice(start, end)\n  })\n  \n  // Check if there are more cars to load\n  const hasMoreCars = computed(() => {\n    return currentPage.value * itemsPerPage.value < filteredCars.value.length\n  })\n\n  const hasLessCars = computed(() => {\n    return currentPage.value !== 1\n  })\n  \n  // Function to load more cars\n  const loadMore = () => {\n    currentPage.value++\n  }\n\n  const loadLess = () => {\n    currentPage.value--\n  }\n\n  // Function to format the current date as \"YYYY-MM-DD\"\n  const getCurrentDate = () => {\n    const today = new Date();\n    const year = today.getFullYear();\n    const month = String(today.getMonth() + 1).padStart(2, '0'); // Month is zero-based\n    const day = String(today.getDate()).padStart(2, '0');\n    return `${year}-${month}-${day}`;\n  };\n\n  // Function to save the updated cars array to araclar.json\n  const saveToDatabase = async () => {\n    try {\n      await $fetch('/api/cars', {\n        method: 'POST',\n        body: cars.value,\n      });\n    } catch (error) {\n      showError.value = true;\n      errorMessage.value = 'Veritabanı güncellenemedi';\n    }\n  };\n\n  // Function to add a new car\n  const addCar = async () => {\n    // Validate input fields\n    if (!newCar.value.arac_id || !newCar.value.arac_sahibi || !newCar.value.adres || !newCar.value.arac_markasi) {\n      showError.value = true;\n      errorMessage.value = 'Lütfen tüm alanları doldurun';\n      return;\n    }\n\n    // Add new car to the list\n    cars.value.unshift({ ...newCar.value, kayit_tarihi: getCurrentDate() });\n\n    // Save to araclar.json\n    await saveToDatabase();\n\n    // Show success message\n    successMessage.value = 'Yeni arac (plakasi: ' + newCar.value.arac_id +') başarıyla eklendi ve kaydedildi!';\n\n    // Remove the message after a delay (e.g., 3 seconds)\n    setTimeout(() => {\n      successMessage.value = '';\n    }, 60000);\n\n    // Clear the input fields\n    newCar.value = { arac_id: '', arac_sahibi: '', adres: '', arac_markasi: '' };\n  };\n\n  // Trigger the modal for confirmation\n  const confirmDelete = (arac_id) => {\n    carToDelete.value = arac_id;\n    showDeleteModal.value = true;\n  };\n\n  // Function to cancel deletion\n  const cancelDelete = () => {\n    showDeleteModal.value = false;\n    carToDelete.value = null;\n  };\n  \n  // Function to delete the car\n  const deleteCar = () => {\n    cars.value = cars.value.filter(car => car.arac_id !== carToDelete.value);\n    showDeleteModal.value = false;\n    carToDelete.value = null;\n    saveToDatabase();  // Save the updated list to the database\n  };\n\n  onMounted(async () => {\n    try {\n      const carsResponse = await fetch('/api/cars');\n\n      if (carsResponse.ok) {\n        cars.value = await carsResponse.json();\n      }\n    } catch (error) {\n      showError.value = true\n      errorMessage.value = 'arac verlieri yüklenemedi.'\n    }\n  });\n</script>\n<style scoped>\n  /* Add Car Section Styling */\n  .add-car-section {\n    margin-bottom: 20px;\n  }\n  \n  .add-car-section input {\n    margin: 5px;\n    padding: 10px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n  }\n  \n  .remove-button,\n  .add-car-section button {\n    padding: 10px 20px;\n    background-color: green;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n  }\n  \n  remove-button,\n  .add-car-section button:hover {\n    background-color: darkgreen;\n  }\n\n  .success-message {\n    color: green;\n    font-weight: bold;\n    margin-top: 10px;\n  }\n\n  .search-input {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 10px 0;\n    box-sizing: border-box;\n    border: 2px solid #ccc;\n    border-radius: 4px;\n    background-color: #f8f8f8;\n    font-size: 16px;\n    transition: border-color 0.3s ease, box-shadow 0.3s ease;\n  }\n\n  .search-input:focus {\n    border-color: #007BFF;\n    box-shadow: 0 0 8px rgba(0, 123, 255, 0.5);\n    outline: none;\n  }\n\n  /* Highlight the selected car's row */\n  .selected-car {\n    background-color: #007BFF;\n    color: white;\n  }\n\n  tbody tr {\n    cursor: pointer;\n    transition: background-color 0.3s ease;\n  }\n\n  tbody tr:hover {\n    background-color: rgb(95, 130, 19);\n    color: white;\n  }\n\n  .table-row {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 50px;\n    height: 50px;\n  }\n\n  .row-element {\n    width: 200px;\n  }\n\n  .row-element-last {\n    width: 200px;\n    margin-left: auto;\n  }\n\n  .load-more-btn {\n    margin: 15px auto;\n    padding: 10px 20px;\n    margin-right: 20px;\n    background-color: #007BFF;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 16px;\n  }\n\n  .load-more-btn:hover {\n    background-color: #0056b3;\n  }\n\n  .load-less-btn {\n    margin: 15px auto;\n    padding: 10px 20px;\n    margin-right: 20px;\n    background-color: #20b1c4;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 16px;\n  }\n\n  .load-less-btn:hover {\n    background-color: #0056b3;\n  }\n\n  .buttons {\n    width: auto;\n    display: flex;\n    flex-direction: row;\n    gap: 10px;\n    justify-content: center;\n  }\n\n  .arrow {\n    font-weight: bold;  /* Make the arrow bold */\n  }\n\n  .arrow-wrapper {\n    background-color: #007BFF;\n    color: white;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 50px;\n    height: 50px;\n    border: 1px solid black;\n    border-radius: 4px;\n  }\n\n  .details-row {\n    background-color: #f9f9f9; /* Light background for the details row */\n  }\n</style>"],"version":3}